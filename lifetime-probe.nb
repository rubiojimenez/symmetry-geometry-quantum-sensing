(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61695,       1321]
NotebookOptionsPosition[     58267,       1246]
NotebookOutlinePosition[     58775,       1266]
CellTagsIndexPosition[     58732,       1263]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Lifetime metrology: probe optimisation", "Title",
 CellChangeTimes->{{3.8172308876435714`*^9, 3.817231007939225*^9}, {
   3.817232781066066*^9, 3.817232802650195*^9}, {3.820566034238792*^9, 
   3.820566070621307*^9}, {3.8205665393998737`*^9, 3.820566595736163*^9}, {
   3.820569710714538*^9, 3.820569712649527*^9}, {3.8226005913864117`*^9, 
   3.822600594798044*^9}, {3.823878437055938*^9, 3.8238784373438587`*^9}, {
   3.823879681485977*^9, 3.8238796851410503`*^9}, {3.824814250386916*^9, 
   3.8248142508896604`*^9}, {3.825049689444072*^9, 3.8250496898239613`*^9}, {
   3.8268910285640335`*^9, 3.8268911705922213`*^9}, {3.8268912420407844`*^9, 
   3.8268912479983325`*^9}, {3.8268913606894636`*^9, 
   3.8268913620706882`*^9}, {3.8339661189791756`*^9, 3.833966119458873*^9}, {
   3.8355419490358133`*^9, 3.8355419871614604`*^9}, 3.8355420635964327`*^9, 
   3.835542095673031*^9, {3.835542336944213*^9, 3.835542358911919*^9}, {
   3.835542528703396*^9, 3.8355425669361386`*^9}, {3.8355426495313396`*^9, 
   3.835542710425622*^9}, {3.8355429999439287`*^9, 3.8355430002647376`*^9}, {
   3.835723999879344*^9, 3.835724011449401*^9}, {3.854208545505245*^9, 
   3.8542085606871433`*^9}, {3.872244253582624*^9, 3.8722442543708076`*^9}, {
   3.872244391698813*^9, 3.8722443922014914`*^9}, {3.924111852211924*^9, 
   3.924111876208262*^9}, {3.924693941651288*^9, 3.924693944198434*^9}, {
   3.924756292577985*^9, 3.924756295369849*^9}, {3.926137254582048*^9, 
   3.926137256159374*^9}, {3.926595188033648*^9, 3.9265951958663282`*^9}, {
   3.9265952416759777`*^9, 3.926595242348826*^9}, {3.9471553171061573`*^9, 
   3.947155327513391*^9}, {3.962035328875711*^9, 3.9620353387873993`*^9}},
 FontSize->36,ExpressionUUID->"767000d7-785a-403a-8259-7ce916f377d8"],

Cell[TextData[{
 StyleBox["Dr Jes\[UAcute]s Rubio",
  FontWeight->"Bold",
  FontColor->GrayLevel[0.5]],
 StyleBox["\nUniversity of Surrey\nj.rubiojimenez@surrey.ac.uk\nORCID iD: ",
  FontColor->GrayLevel[0.5]],
 StyleBox[ButtonBox["0000-0002-8193-8273",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://orcid.org/0000-0002-8193-8273"], None},
  ButtonNote->"https://orcid.org/0000-0002-8193-8273"],
  FontWeight->"Bold",
  FontColor->RGBColor[0., 0.25098039215686274`, 0.5019607843137255]],
 StyleBox["\n",
  FontWeight->"Bold",
  FontColor->RGBColor[0., 0.25098039215686274`, 0.5019607843137255]],
 "\n",
 StyleBox["Created",
  FontWeight->"Bold"],
 ": May 2024\n",
 StyleBox["Last update",
  FontWeight->"Bold"],
 ": July 2025"
}], "Text",
 CellChangeTimes->{{3.8172308876435714`*^9, 3.817231007939225*^9}, {
   3.817232781066066*^9, 3.817232802650195*^9}, {3.820566034238792*^9, 
   3.820566070621307*^9}, {3.8205665393998737`*^9, 3.820566595736163*^9}, {
   3.820569710714538*^9, 3.820569712649527*^9}, {3.8226005913864117`*^9, 
   3.822600594798044*^9}, {3.823878437055938*^9, 3.8238784373438587`*^9}, {
   3.823879681485977*^9, 3.8238796851410503`*^9}, {3.824814250386916*^9, 
   3.8248142508896604`*^9}, {3.825049689444072*^9, 3.8250496898239613`*^9}, {
   3.8268910285640335`*^9, 3.8268911705922213`*^9}, {3.8268912420407844`*^9, 
   3.8268912479983325`*^9}, {3.8268913606894636`*^9, 
   3.8268913620706882`*^9}, {3.8339661189791756`*^9, 3.833966119458873*^9}, {
   3.8355419490358133`*^9, 3.8355419871614604`*^9}, 3.8355420635964327`*^9, 
   3.835542095673031*^9, {3.835542336944213*^9, 3.835542358911919*^9}, 
   3.835542528703396*^9, {3.835542650580232*^9, 3.8355426692237377`*^9}, {
   3.835542720908942*^9, 3.8355428346728125`*^9}, {3.8355428662512007`*^9, 
   3.8355428675754623`*^9}, {3.8355429121001053`*^9, 
   3.8355429121001053`*^9}, {3.8355429519996758`*^9, 
   3.8355429541515107`*^9}, {3.8355430082472153`*^9, 3.835543198011278*^9}, {
   3.835543259787874*^9, 3.8355433236326246`*^9}, {3.835543388665143*^9, 
   3.8355433922632275`*^9}, {3.8355440089036713`*^9, 
   3.8355440098562374`*^9}, {3.8355440518478436`*^9, 3.835544074400981*^9}, {
   3.83554645476853*^9, 3.835546485176615*^9}, {3.8355465535525613`*^9, 
   3.8355465681054497`*^9}, {3.835546905978796*^9, 3.8355469313844028`*^9}, {
   3.8355469828192472`*^9, 3.8355469828212447`*^9}, {3.8355470145553885`*^9, 
   3.8355470195554523`*^9}, {3.8355481167059216`*^9, 3.835548187553233*^9}, {
   3.835551380398299*^9, 3.835551411261696*^9}, {3.8355518576782064`*^9, 
   3.83555185820581*^9}, {3.8357238118889837`*^9, 3.835723827607606*^9}, {
   3.835723959519184*^9, 3.8357239732572002`*^9}, {3.835724016788292*^9, 
   3.835724036166375*^9}, {3.8371679722825184`*^9, 3.837167974882457*^9}, {
   3.850675683116221*^9, 3.85067576736903*^9}, {3.85067582490676*^9, 
   3.850675841654817*^9}, {3.850676402546504*^9, 3.8506764028944387`*^9}, {
   3.85067650483491*^9, 3.8506765051481447`*^9}, {3.854208569544867*^9, 
   3.85420857367701*^9}, {3.87102224168944*^9, 3.8710222453987207`*^9}, {
   3.87216232819492*^9, 3.872162335568699*^9}, {3.872398334359694*^9, 
   3.87239833902803*^9}, {3.875605391355953*^9, 3.8756053917252703`*^9}, {
   3.8805149204716063`*^9, 3.880514953461142*^9}, {3.880514985396031*^9, 
   3.880514985876367*^9}, {3.9180330654051437`*^9, 3.918033082647944*^9}, {
   3.9240924284049616`*^9, 3.924092457392357*^9}, {3.9240936657759542`*^9, 
   3.9240936676548996`*^9}, {3.9265950370214167`*^9, 3.926595039558844*^9}, {
   3.947150118340732*^9, 3.947150121329013*^9}, {3.947851485672014*^9, 
   3.9478514865495453`*^9}, {3.9620353164208517`*^9, 
   3.9620353190799713`*^9}},ExpressionUUID->"a03051b2-2b03-4276-b16a-\
9e3d90437730"],

Cell[CellGroupData[{

Cell["\<\
Preamble: prior information, probe state, and symmetry function\
\>", "Section",
 CellChangeTimes->{{3.817231011361639*^9, 3.817231019632612*^9}, {
   3.817231539732112*^9, 3.8172318130827694`*^9}, {3.817232041435583*^9, 
   3.8172320624640307`*^9}, {3.817232235182582*^9, 3.8172322675294228`*^9}, {
   3.8172323983898363`*^9, 3.8172323987058587`*^9}, {3.8172324540341635`*^9, 
   3.8172324592404723`*^9}, {3.8172325518477707`*^9, 3.817232673192151*^9}, {
   3.8172327685765123`*^9, 3.8172327764678965`*^9}, {3.817232812123248*^9, 
   3.8172328382303715`*^9}, {3.817232879496555*^9, 3.817232917071907*^9}, {
   3.8172330688869343`*^9, 3.817233101257606*^9}, {3.817233230341447*^9, 
   3.8172332316980023`*^9}, {3.8172336161494904`*^9, 
   3.8172336169447393`*^9}, {3.8172402845762377`*^9, 3.817240313854489*^9}, {
   3.817240700095315*^9, 3.817240713753161*^9}, {3.8355434179389277`*^9, 
   3.8355434561448793`*^9}, {3.8355475671524434`*^9, 3.835547603009199*^9}, {
   3.8355480834025297`*^9, 3.835548085224724*^9}, {3.835724066743053*^9, 
   3.835724079671558*^9}, {3.872151723681982*^9, 3.872151726401067*^9}, {
   3.924104715135186*^9, 3.924104715831299*^9}, {3.924104784238954*^9, 
   3.924104790389903*^9}, {3.926137260065322*^9, 3.9261372609700193`*^9}, 
   3.9265952438192253`*^9, {3.947155305164287*^9, 3.947155313509862*^9}},
 FontSize->24,ExpressionUUID->"74549090-f68b-47b6-acbc-910ca3bf395a"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "\[Theta]min", ",", "\[Theta]max", ",", "a", ",", "p", ",", "\[Rho]", ",", 
   "\[Eta]", ",", "f"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]min", "=", 
   RowBox[{"1", "/", "a"}]}], ";", 
  RowBox[{"\[Theta]max", "=", "a"}], ";", 
  RowBox[{"p", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[Theta]", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"1", "/", "\[Theta]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Theta]min", ",", "\[Theta]max"}], 
         "}"}]}], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Eta]", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", " ", "1"}], "/", "\[Theta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"\[Eta]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}]}], "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", " ", "1"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "\[Theta]"}], ")"}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"\[Eta]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}]}], "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", " ", "1"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "\[Theta]"}], ")"}]}], "]"}]}], ",", 
       RowBox[{"1", "-", 
        RowBox[{"\[Eta]", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", " ", "1"}], "/", "\[Theta]"}], "]"}]}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "\[Theta]_", "]"}], "=", 
   RowBox[{"Log", "[", "\[Theta]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.817231011361639*^9, 3.817231019632612*^9}, {
   3.817231539732112*^9, 3.8172318130827694`*^9}, {3.817232041435583*^9, 
   3.8172320624640307`*^9}, {3.817232235182582*^9, 3.8172322675294228`*^9}, {
   3.8172323983898363`*^9, 3.8172323987058587`*^9}, {3.8172324540341635`*^9, 
   3.8172324592404723`*^9}, {3.8172325518477707`*^9, 3.817232673192151*^9}, {
   3.8172327685765123`*^9, 3.8172327764678965`*^9}, {3.817232812123248*^9, 
   3.8172328382303715`*^9}, {3.817232879496555*^9, 3.817232917071907*^9}, {
   3.8172330688869343`*^9, 3.817233101257606*^9}, {3.817233230341447*^9, 
   3.8172332316980023`*^9}, {3.8172336161494904`*^9, 
   3.8172336169447393`*^9}, {3.8172402845762377`*^9, 3.817240313854489*^9}, {
   3.817240700095315*^9, 3.817240713753161*^9}, 3.8355434179389277`*^9, {
   3.8355434662418947`*^9, 3.835543468289589*^9}, {3.835724166383893*^9, 
   3.8357241891392937`*^9}, {3.835724317459485*^9, 3.835724321395094*^9}, {
   3.835724456560145*^9, 3.835724515080731*^9}, {3.835724882093993*^9, 
   3.835724890636076*^9}, {3.835725001201933*^9, 3.83572500517222*^9}, {
   3.8357251426490583`*^9, 3.835725143423622*^9}, {3.835725189007207*^9, 
   3.835725198415036*^9}, {3.8357253676039886`*^9, 3.835725379857441*^9}, {
   3.8357294333830338`*^9, 3.8357294340891657`*^9}, {3.835729482440118*^9, 
   3.8357294955249157`*^9}, {3.835729553590761*^9, 3.835729651686192*^9}, {
   3.835729891684064*^9, 3.835729931483387*^9}, 3.835730034044355*^9, {
   3.8357300980174913`*^9, 3.8357300982874737`*^9}, {3.835730151055863*^9, 
   3.8357301511200457`*^9}, {3.835730230853553*^9, 3.835730231106888*^9}, {
   3.8357303619631977`*^9, 3.8357304199925547`*^9}, {3.835730468121952*^9, 
   3.835730484103492*^9}, {3.835730529756579*^9, 3.835730535504137*^9}, {
   3.835730604263933*^9, 3.835730606640465*^9}, {3.8357307509796057`*^9, 
   3.835730752610021*^9}, {3.8357308359718246`*^9, 3.835730836388538*^9}, {
   3.835730877635817*^9, 3.835730945119426*^9}, {3.8357310341760263`*^9, 
   3.835731044574071*^9}, {3.835731111930275*^9, 3.835731125112958*^9}, {
   3.835731204850637*^9, 3.8357312070521917`*^9}, {3.835731304620784*^9, 
   3.8357313285162563`*^9}, 3.8357729151604495`*^9, 3.8357730110038652`*^9, {
   3.8357730508330126`*^9, 3.835773061673064*^9}, {3.8357738844422417`*^9, 
   3.8357738989182043`*^9}, {3.854209003650428*^9, 3.854209013005081*^9}, {
   3.854209699286759*^9, 3.85420970403458*^9}, {3.8542097394875793`*^9, 
   3.854209743579658*^9}, {3.854214957007764*^9, 3.854214957108367*^9}, {
   3.8710380420662203`*^9, 3.871038042200327*^9}, {3.8720725956726303`*^9, 
   3.872072598693561*^9}, {3.872072799866502*^9, 3.872072814937142*^9}, {
   3.8720729671688557`*^9, 3.872073042788295*^9}, {3.8721485524995728`*^9, 
   3.872148556817185*^9}, {3.872153022457018*^9, 3.872153030108344*^9}, {
   3.8722364660848017`*^9, 3.8722364824103737`*^9}, 3.872243780366664*^9, {
   3.872249009944438*^9, 3.8722490109603643`*^9}, {3.872249054741448*^9, 
   3.872249055297337*^9}, {3.8722490991011763`*^9, 3.87224909916222*^9}, 
   3.872249130158293*^9, {3.87224918781702*^9, 3.872249189109424*^9}, {
   3.87225000442482*^9, 3.8722500047582903`*^9}, 3.8723899689886217`*^9, {
   3.872390014489229*^9, 3.8723900448614273`*^9}, {3.872390143241707*^9, 
   3.872390157907494*^9}, {3.872390246043806*^9, 3.87239027055464*^9}, {
   3.8723912773640537`*^9, 3.872391317876737*^9}, {3.87239506163488*^9, 
   3.87239508490432*^9}, {3.872395115934266*^9, 3.872395210783689*^9}, {
   3.872395279014902*^9, 3.872395279081667*^9}, {3.872395622931617*^9, 
   3.872395623434684*^9}, {3.87239569957197*^9, 3.872395699963397*^9}, {
   3.872395791698654*^9, 3.8723958123928013`*^9}, {3.8723958552227783`*^9, 
   3.872395879207374*^9}, 3.872395912899227*^9, {3.872395949992765*^9, 
   3.872395962757185*^9}, {3.872396004329801*^9, 3.872396047603334*^9}, {
   3.872396250401886*^9, 3.872396276307796*^9}, 3.872396449751891*^9, {
   3.8723965006411133`*^9, 3.872396500774087*^9}, {3.872396619509111*^9, 
   3.872396651110167*^9}, {3.872396788382464*^9, 3.872396814529099*^9}, {
   3.872396852016912*^9, 3.8723968891991453`*^9}, 3.872397210069153*^9, {
   3.8723972564582033`*^9, 3.872397268120812*^9}, {3.872397300349741*^9, 
   3.8723973213177233`*^9}, {3.8723974932916527`*^9, 
   3.8723974942072573`*^9}, {3.8727840633464665`*^9, 
   3.8727840828271914`*^9}, {3.872784120054778*^9, 3.872784138258565*^9}, {
   3.8727841955853987`*^9, 3.872784202551977*^9}, {3.8727862810806866`*^9, 
   3.872786305309044*^9}, 3.8727863674447374`*^9, {3.872786419993391*^9, 
   3.87278644209984*^9}, {3.87278651888435*^9, 3.8727865614769063`*^9}, 
   3.8727866918452888`*^9, 3.8727867354574018`*^9, {3.8727881188361235`*^9, 
   3.8727881440924835`*^9}, {3.8727953894409094`*^9, 3.872795413173297*^9}, {
   3.872795573158573*^9, 3.8727955737895555`*^9}, {3.8727971535650735`*^9, 
   3.872797158300144*^9}, {3.8730846068750343`*^9, 3.8730846300014625`*^9}, {
   3.8731078427228293`*^9, 3.8731078433771353`*^9}, {3.873112077842058*^9, 
   3.873112082466316*^9}, 3.8731174446207485`*^9, 3.873117504796088*^9, {
   3.873117546173997*^9, 3.8731176158521757`*^9}, {3.8731180971398664`*^9, 
   3.8731180981804123`*^9}, {3.873118355275239*^9, 3.8731183726357374`*^9}, {
   3.873118419204496*^9, 3.8731184214989986`*^9}, 3.8731185542401586`*^9, {
   3.924092594693694*^9, 3.924092604642001*^9}, {3.9240926413483744`*^9, 
   3.924092657613833*^9}, {3.9240928900546055`*^9, 3.924092890710889*^9}, {
   3.9240945655150867`*^9, 3.9240945744579797`*^9}, {3.924094622466798*^9, 
   3.9240946332790923`*^9}, {3.924094688466653*^9, 3.9240946896572485`*^9}, {
   3.9240947271787853`*^9, 3.9240947324064035`*^9}, {3.9247574327886267`*^9, 
   3.924757462772517*^9}, {3.9471552888283463`*^9, 3.9471552913914757`*^9}, {
   3.9471553364343357`*^9, 3.947155349945283*^9}, 3.9471553954135647`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"adda10d2-08f0-406f-87f9-9c490536ee54"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Probe optimisation", "Section",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQ3TMpO+RUwRvHGLuSUBBdlls+DUTzLFu0A0T7fNC9
CqLDb567DqK3XU99C6I5PhZ8BNFdlWcYTwPp1GnXwPQ98YMcIPrzxnROEP1B
4bcIiJZSU1MB0aeKhAxANNNPPkMQvexjsymINok/bgGijz9+bwuiBXwXOYHo
I4lzQkG0v92KSBCt9PZUJojmDPsGphecYJkFov2s5cB0V8Gk2+eA9M9w6/sg
+hJPM/95IP1U0kIQRG/itnu/ffIbx1uLWL6A6IsPnnzdCaRjvBN+gei2hzlm
u4D0B4PlYFr8eLiKwJQ3jum1X1VBtJasx/3tN984Cr2pBtOyz9gfLrJ563if
OxlM75ruwfHQ9q3jMoEiMD376S1/EP3vyWswnXDwWQ+IfrNYoRdEAwClutMe

  "],
 FontSize->24,ExpressionUUID->"d3a8ef32-eb94-4841-9a5d-c4182692f2dd"],

Cell[CellGroupData[{

Cell[TextData[{
 " ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "0"], TraditionalForm]],ExpressionUUID->
  "b84e918b-7c58-4396-8183-9b6895b1ddb2"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "1"], TraditionalForm]],ExpressionUUID->
  "5a68309f-bc63-4ffd-afe7-9dec578c37df"],
 " and S operators"
}], "Subsection",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.835544215236469*^9, 3.835544256497331*^9}, {
   3.8355442868352365`*^9, 3.835544333981597*^9}, {3.835544372403955*^9, 
   3.8355443741938467`*^9}, {3.835544411017234*^9, 3.8355444325933485`*^9}, {
   3.835725067480699*^9, 3.835725074133206*^9}, {3.835725262711372*^9, 
   3.835725272072914*^9}, {3.835727012727154*^9, 3.835727021238976*^9}, {
   3.9240937845862117`*^9, 3.924093789584131*^9}, {3.9247879519685173`*^9, 
   3.92478795940701*^9}},
 FontSize->18,ExpressionUUID->"41869885-8cff-4460-b8e9-d5632f56cb6d"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"temp0", ",", "temp1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp0", "[", "\[Theta]_", "]"}], "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"p", " ", "\[Rho]"}], ",", "\[Theta]"}], "]"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"temp1", "[", "\[Theta]_", "]"}], "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"p", " ", "\[Rho]", " ", 
       RowBox[{"f", "[", "\[Theta]", "]"}]}], ",", "\[Theta]"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.8355443003524675`*^9, 3.835544311743806*^9}, 
   3.835544446392237*^9, 3.835544607522483*^9, {3.835725208266526*^9, 
   3.835725246183057*^9}, {3.835725278319456*^9, 3.8357253069770403`*^9}, {
   3.8357253995882483`*^9, 3.835725441329709*^9}, {3.835725480656118*^9, 
   3.835725523404723*^9}, {3.835727029332864*^9, 3.8357270445097446`*^9}, {
   3.8357273590343437`*^9, 3.835727367492949*^9}, {3.83573085033569*^9, 
   3.835730894127975*^9}, 3.835731015327753*^9, {3.8357726866979074`*^9, 
   3.835772726705924*^9}, {3.8357728943609676`*^9, 3.8357728988096943`*^9}, {
   3.83577317839072*^9, 3.835773185293412*^9}, {3.835773255451106*^9, 
   3.8357732767248864`*^9}, {3.8357737123591747`*^9, 
   3.8357737126328907`*^9}, {3.8357737595235233`*^9, 
   3.8357738567336893`*^9}, {3.8542096707087793`*^9, 3.854209682885769*^9}, {
   3.854209766965343*^9, 3.8542097727757072`*^9}, {3.854210127574819*^9, 
   3.854210142557665*^9}, {3.8542110169425173`*^9, 3.854211020292432*^9}, {
   3.854211590287738*^9, 3.854211595583603*^9}, {3.854211986862808*^9, 
   3.854212113743753*^9}, {3.8723901810533237`*^9, 3.87239020020682*^9}, {
   3.872390502753491*^9, 3.8723905496520643`*^9}, {3.872390765577033*^9, 
   3.8723908362368402`*^9}, {3.872390895813867*^9, 3.872390950937789*^9}, {
   3.8723912093786716`*^9, 3.872391271594359*^9}, {3.872395010123864*^9, 
   3.8723950208922157`*^9}, {3.873121286913228*^9, 3.8731213006339855`*^9}, 
   3.8731230630719614`*^9, {3.9240930550718155`*^9, 3.9240930700589943`*^9}, {
   3.924093180639164*^9, 3.924093180849572*^9}, {3.9240933179370427`*^9, 
   3.9240934249293404`*^9}, {3.9240934592864976`*^9, 3.924093492561031*^9}, {
   3.9240936753971643`*^9, 3.9240937793489847`*^9}, {3.9240947752974153`*^9, 
   3.9240947814296904`*^9}, {3.9240949606053133`*^9, 
   3.9240949607512712`*^9}, {3.9240952729998474`*^9, 3.924095276430949*^9}, 
   3.924756729687201*^9, {3.924756866565132*^9, 3.9247568735108852`*^9}, {
   3.924756944494041*^9, 3.924756968190218*^9}, {3.926138309447974*^9, 
   3.926138320119495*^9}, 3.9471554053739147`*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"72ead34d-cec7-4025-b947-0bbbad4aa368"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Rho]0", " ", ",", "\[Rho]1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FormBox["\[Rho]0",
    TraditionalForm], "=", 
   RowBox[{
    RowBox[{"temp0", "[", "\[Theta]max", "]"}], "-", 
    RowBox[{"temp0", "[", "\[Theta]min", "]"}]}]}], ";", 
  RowBox[{
   FormBox["\[Rho]1",
    TraditionalForm], "=", 
   RowBox[{
    RowBox[{"temp1", "[", "\[Theta]max", "]"}], "-", 
    RowBox[{"temp1", "[", "\[Theta]min", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.8355443003524675`*^9, 3.835544311743806*^9}, 
   3.835544446392237*^9, 3.835544607522483*^9, {3.835725208266526*^9, 
   3.835725246183057*^9}, {3.835725278319456*^9, 3.8357253069770403`*^9}, {
   3.8357253995882483`*^9, 3.835725441329709*^9}, {3.835725480656118*^9, 
   3.835725523404723*^9}, {3.835727029332864*^9, 3.8357270445097446`*^9}, {
   3.8357273590343437`*^9, 3.835727367492949*^9}, {3.83573085033569*^9, 
   3.835730894127975*^9}, 3.835731015327753*^9, {3.8357726866979074`*^9, 
   3.835772726705924*^9}, {3.8357728943609676`*^9, 3.8357728988096943`*^9}, {
   3.83577317839072*^9, 3.835773185293412*^9}, {3.835773255451106*^9, 
   3.8357732767248864`*^9}, {3.8357737123591747`*^9, 
   3.8357737126328907`*^9}, {3.8357737595235233`*^9, 
   3.8357738567336893`*^9}, {3.8542096707087793`*^9, 3.854209682885769*^9}, {
   3.854209766965343*^9, 3.8542097727757072`*^9}, {3.854210127574819*^9, 
   3.854210142557665*^9}, {3.8542110169425173`*^9, 3.854211020292432*^9}, {
   3.854211590287738*^9, 3.854211595583603*^9}, {3.854211986862808*^9, 
   3.854212113743753*^9}, {3.8723901810533237`*^9, 3.87239020020682*^9}, {
   3.872390502753491*^9, 3.8723905496520643`*^9}, {3.872390765577033*^9, 
   3.8723908362368402`*^9}, {3.872390895813867*^9, 3.872390950937789*^9}, {
   3.8723912093786716`*^9, 3.872391271594359*^9}, {3.872395010123864*^9, 
   3.8723950208922157`*^9}, {3.873121286913228*^9, 3.8731213006339855`*^9}, 
   3.8731230630719614`*^9, {3.9240930550718155`*^9, 3.9240930700589943`*^9}, {
   3.924093180639164*^9, 3.924093180849572*^9}, {3.9240933179370427`*^9, 
   3.9240934249293404`*^9}, {3.9240934592864976`*^9, 3.924093492561031*^9}, {
   3.9240936753971643`*^9, 3.9240937391874647`*^9}, {3.92409382112914*^9, 
   3.9240939102438126`*^9}, {3.9240939728589153`*^9, 3.9240939859507*^9}, {
   3.9240947893618994`*^9, 3.92409479083926*^9}, {3.9247567529172173`*^9, 
   3.924756764919424*^9}, {3.924756840423884*^9, 3.924756843921133*^9}, {
   3.926138313003433*^9, 3.926138331213564*^9}, {3.947155376849689*^9, 
   3.947155402048065*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"5d3a53dc-2d56-482d-bd35-ad3b2b83a3f5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "S", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"LyapunovSolve", "[", 
    RowBox[{"\[Rho]0", ",", 
     RowBox[{"2", "\[Rho]1"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.8355443003524675`*^9, 3.835544311743806*^9}, 
   3.835544446392237*^9, 3.835544607522483*^9, {3.835725208266526*^9, 
   3.835725246183057*^9}, {3.835725278319456*^9, 3.8357253069770403`*^9}, {
   3.8357253995882483`*^9, 3.835725441329709*^9}, {3.835725480656118*^9, 
   3.835725523404723*^9}, {3.835725609095207*^9, 3.83572562793962*^9}, {
   3.835725712778672*^9, 3.835725742259259*^9}, {3.8357732484470596`*^9, 
   3.835773269374962*^9}, {3.854209780342564*^9, 3.8542097833892593`*^9}, {
   3.854211214987516*^9, 3.8542112571178827`*^9}, {3.871038341359666*^9, 
   3.871038348203087*^9}, {3.871114822336396*^9, 3.871114828380064*^9}, {
   3.87239028888155*^9, 3.872390325771776*^9}, {3.872391354896977*^9, 
   3.8723914139627438`*^9}, {3.8723949339101*^9, 3.872394952556538*^9}, {
   3.8728007807148457`*^9, 3.872800782796612*^9}, {3.9240940051708317`*^9, 
   3.9240940054361086`*^9}, {3.9247567383848333`*^9, 3.92475673896148*^9}, {
   3.924756851731119*^9, 3.924756855486629*^9}, {3.9254616079842176`*^9, 
   3.925461609860599*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"d14233e0-4af5-4b96-8e27-1173f72dd7e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Absolute precision gain", "Subsection",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.835544215236469*^9, 3.835544256497331*^9}, {
   3.8355442868352365`*^9, 3.835544333981597*^9}, {3.835544372403955*^9, 
   3.8355443741938467`*^9}, {3.835544411017234*^9, 3.8355444325933485`*^9}, {
   3.835725067480699*^9, 3.835725074133206*^9}, {3.835725262711372*^9, 
   3.835725272072914*^9}, {3.835725594073031*^9, 3.8357255965718393`*^9}, {
   3.9241050269662333`*^9, 3.9241050625182533`*^9}, {3.924788308505961*^9, 
   3.924788311194861*^9}, {3.947155433409698*^9, 3.9471554412687473`*^9}},
 FontSize->18,ExpressionUUID->"9b651d5f-ee0b-4528-ba46-6e00562edfc5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"a", ",", "insetProbe"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"insetProbe", "=", 
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"Tr", "[", 
         RowBox[{"S", ".", "\[Rho]1"}], "]"}], "]"}], "/.", 
       RowBox[{"a", "\[Rule]", "2"}]}], ",", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"Tr", "[", 
         RowBox[{"S", ".", "\[Rho]1"}], "]"}], "]"}], "/.", 
       RowBox[{"a", "\[Rule]", "10"}]}], ",", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"Tr", "[", 
         RowBox[{"S", ".", "\[Rho]1"}], "]"}], "]"}], "/.", 
       RowBox[{"a", "\[Rule]", "100"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Eta]", ",", "0.01", ",", "0.99"}], "}"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"\"\<Times\>\"", ",", "13", ",", "Black"}], "]"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "Black", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"DotDashed", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Dotted", ",", "Black"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\[Eta]\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalG]\), \(\[Eta]\)]\)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.35"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1.1"}], "}"}], ",", "All"}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0.0001", ",", "\"\<\!\(\*SuperscriptBox[\(10\), \(-4\)]\)\>\""}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.0002", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.0003", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.0004", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.0005", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.0006", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.0007", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.0008", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.0009", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.001", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.002", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.003", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.004", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.005", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.006", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.007", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.008", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.009", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0.01", ",", "\"\<\!\(\*SuperscriptBox[\(10\), \(-2\)]\)\>\""}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.02", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.03", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.04", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.05", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.06", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.07", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.08", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.09", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.1", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.2", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.3", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.4", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.6", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.7", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.8", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.9", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "\"\<1\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.1", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.2", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.3", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.4", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.5", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.6", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.7", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.8", ",", "\"\<\>\""}], "}"}]}], "}"}], ",", "None"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0.01", ",", "\"\<\!\(\*SuperscriptBox[\(10\), \(-2\)]\)\>\""}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.02", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.03", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.04", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.05", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.06", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.07", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.08", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.09", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0.1", ",", "\"\<\!\(\*SuperscriptBox[\(10\), \(-1\)]\)\>\""}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.2", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.3", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.4", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.6", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.7", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.8", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.9", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "\"\<1\>\""}], "}"}]}], "}"}], ",", " ", 
         "None"}], "}"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9261454955249577`*^9, 3.926145596429431*^9}, {
   3.926145725614456*^9, 3.926145763202447*^9}, {3.926145824963744*^9, 
   3.9261459697090607`*^9}, {3.926146009857839*^9, 3.926146144134553*^9}, 
   3.926146528768437*^9, {3.926146718067026*^9, 3.926146723488184*^9}, {
   3.9261474261057787`*^9, 3.926147428724761*^9}, {3.926595464416181*^9, 
   3.92659552880722*^9}, {3.926596158412586*^9, 3.926596185398019*^9}, 
   3.926596250725346*^9, {3.926596675067691*^9, 3.926596675168536*^9}, 
   3.926596757987101*^9, {3.926597025477162*^9, 3.926597025504722*^9}, {
   3.926613279580996*^9, 3.926613280882228*^9}, {3.947155465720152*^9, 
   3.947155484556332*^9}, {3.947155622697508*^9, 3.947155627010696*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"19b7796a-ca30-4884-8b45-0dedbf4f662c"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {GrayLevel[0], AbsoluteThickness[1.6], Opacity[1.], 
      LineBox[CompressedData["
1:eJwVxX0803kcAHCEOGv2/SkWGzbRg8Nyk7uieS6deYrIKyaRTl3nbLwqdTes
RuEUvdKqEWo90dW1jqLvR00oT1Eq5SFEZSRFdvNwd3+8X29GzC/BcVoaGhrc
//y/t2uC/MZuAjZ+JJwS85lQuGupl1sCARDIt/r7BBOU+Q3tLbsIiP1yAc0d
Z0LBB5vxkTgCzhWnjR7LY8LgqYFVNtEEuPcalspymCCa2FYsCSFAHpmk0ytm
gkIWcCzDlYAV6qKL3INM8CCctocaEkBifg1ZFceEm7jamX0VwTXjreEzjkxo
I7dXyrkI4tlqGV2bCT2oq4o0QQHavl6yTScDokalb6W5FBDasws9yxiQk/Dp
bsdqCjT4tAmvJzMgUqh5QCwxhJk2Yb2dJwOE+ToHiWdkgJeJsX8gBsy/X9bR
TyNDjN8Qdf2AJez4VPP7ytBFUHurtVP1pyUsc0lKk0tIEOX7wk0z3RIUYwYZ
ygED2P9w1v79ZkvwDbboOk03gArdyledDEuwVXGPZMd+A13fMcS0IQuYCJwS
T57Rhw8nhK8zhRZQSBFl6T/XA6nZmFUZzQIkRnZ9MRZ64KGZHOKPzSG9PiDb
MXwh3JEefvd6qzk8vJeTs0GqC6+irSMm/6HDx53eg+1PdeD3eG2HV/l0mE7p
X6tvqANZ+7I4ofZ0iHwkGRJt0Qaxxpc3m1tpIGtpGk7JXQBV/CLz6Xga+Bub
rq/o0IIHlkMnTBfS4GmdX0EeTQuUegklCpkZcGxUnPehmuBTs9x/gGMGuo/A
TXxWA6ZUPH5qjynsdNW2d5bN4+CqPaxtAlP47XZQl5w2h82HqX7HDUwh4PYz
Fr42g8fXnRK5XF4KIyZcRzldjbs4a6qHXZcCR0Pd7XRZha+UcnS1XlIhuJKf
RXKZxg41BfKYZCo4tPf2tl6fwk3NMYKf9ahQl5TeR18/iS/xmZHD503AJpma
HV7+GevNLp7Hq02AMzf4hu48gY00rmRrNhiDSdhB5x8axjEtzLg9kGcMfCty
YrpgDM/dg9tHlUtg5cW8OlnOCE7pIHk5CZeAQKlKvLjrHY5WbGLF6y8Bl/Zp
s6Dgt3inaLTbLX8xJNfFmqFf+3Fmd83sWavFkDm9901IaQ/u3Talq7xkBHpp
Y+ybLS/wirZvG++zjSB942lxvEkHrs4TTP5YSwDX3opUVN+I3eeDpLYeBPyl
lSfP/Kkac22f86obEcQQZevstKqx52zNUWk9AoJZWftEchdHcEXHhXUIktz7
mk2b7mCfBRJHr1oELCFr6Jp9FX4QG3K/sRJB+Wyb8ZPPcuyXyzNqkSEI+GQ1
7jhTgVOF81vuHkZQQfGbSbWrwJvUpz8XZiAgswR6dVHlOJyxZ3dKGoKmvQrL
sNqrWDBaomQdQuCrjA1KPXIJp29/zC4TIPAcvnDzAaUEmyoKnmfsQFCi23KP
5HEehxX7WPO2I9CymXoUyi/GQeoe7loeAmFj9sPWq+cwz/q6w3gEggOK5uXU
Naew+pC7U0Qwgu8XmLtdKTyJH6ec2coORPDVfW+4izofv6PcCif7IxBgclY0
5OFm3qLhWl8EcTM1Hm+9c/Eg2yvlzAYE/fuj+PoGx7BqxLpP4I0g+utcqV2b
GNtKypf5eyLoFhQ9DTopwje2dHoud0fwL5yJbUs=
       "]]},
     Annotation[#, "Charting`Private`Tag$11544#1"]& ], 
    TagBox[
     {GrayLevel[0], AbsoluteThickness[1.6], Opacity[1.], 
      Dashing[{0, Small, Small, Small}], LineBox[CompressedData["
1:eJwVy3840wkcwHHGmGi273rolyhFzilcuDJNslPP0xJHXNE5v9OdifFUVJJr
+bEeT3hoiVKixF27Z10Jn09FPzx+bLNwrjQ/Vn4M82uIuO6P9/P+67UxlOsb
QdLS0uJ87f+z3WLED08QmPpgVVCAgIGF0Ws83WMIVM/WH/iYxUBV7mtZazSB
X8oy3RIzGZg3bKUeiSAw2e+SeS6fgQMF/d9YhRBYuIWmbL3AwPTJoJtCPwLz
NUlJPyQxsKHcO+uiG4H0f9+JnH5moAfh9Iu/MYFRAdy8VQ4MFEGty45KOpbU
11XSWwiUUGWPxRw6Mi3M9URcAnvo3U+MJmkYrugdtFlF4LHRYmXxFRrGcIvU
fX/SURAz8bTdgYYOzq1slh8dg1O1z/CFxkhqSla8H6dhai45hXhLxfxhT09/
AQ2Xhza3962n4jmuzTj3qwubqDtv478So0zk3jeuG+NmZvwFsdAIre8n8m71
UrFhzPCiqt8Q73iFxQfYUnG/r3n3NTNDHHJmnr4WsRJt5zmXssNXYOiRq+Ub
q4xw8pCGP3PdANXKWf2dSkMspKVnGHRSULOgu5280RCFDDtFqDkF4wq6nE1i
VmDaK+9sx0B9TIoVJ9XcNsCX9QKBV7EeWogJQekwBccj2QMyORmfe/WHWGyi
4FxS3y4DYzI+zPON8Q3Wx+Am4cf0w7oYn6dOayjTw/LW5k9JV3TQ4fliUEsP
GQ+arN1d3U5CdcZwBbGFjPLGA3k560nIZ9mpdLm6yLKaZw35ayNJa4Vl5j0d
1GtCd36RFgoLdlZ5TJAw0k13m0v5MjCrFnT4NiQ898inW7x+CU4WaQajI7TR
+9Fbe3iwCPw2/hFutRaOmHIcxWYLoAxsy+xoWwaW1sJ7p3vz4Gpdz/4ctAS+
jxMyjJhz4BnsN7lhYhG2yz58aPtDA05nvz3+LmIBGuPTFGa7Z+DXalazYHoe
rBJXZwdWTYGx1cBMStgcsJYGes1cJuEoTRK/VaUB04AUl52v1cCsJWpYyTOQ
YEmNS+ONwdRcGbNzaAps7uY0lgtG4PiPlw9JTk4CTzUfdzd6EOJmpKeyur46
2dw6H18lfIheU8vOGIPExvB19JN9cGL64Paw3BG4PBfb63e7B6zdup1dAgeB
cmFsh6i1C97VfZa4HlRC2r5r/CjTduj2rCtK5fQBZ5ulUcmrNxCQncHr0O+B
v0g54svHa2E0/2z07287IZS442pHqoWKO7ah4iedQGx6/EwqfApkYSR14EYn
xO9RtKxtrgHRVFiKW2Qn2Kfaf3yw7Qm82lpcotB0QNUXiYl0SgwFh0ezPpl2
gPeEpdpxsRrSfutlTQfKoZp2YDHZrhqixeNp80w5UO15lMZjVRC2zIv6YiGH
5tgGi4BnlfCdVz2hPdQO+1XhPsmXKoD/lNk/e6od9n4qE72glUILZ/9UaaEM
SvVa6408bgFFZL/yaooMSFaaJv+Em9C/Tw3nQ2SQ+ib7ZVvlDfjnRevo4a0y
ONPQYr3auQBidymPTv8the91NrjfL8wH1UCMXdd1KczuiQ1kLuQCWzsxt+a8
FHhAzQjBHDBTjKxN9pJCxGKdh5J9Bej2e11/spVC3+ljCQaGWdBNnR51MpZC
yOzSbTsJH6IqEhzpUxJ4zyuR++Sng8rChTLSIYH/AO31kB4=
       "]]},
     Annotation[#, "Charting`Private`Tag$11544#2"]& ], 
    TagBox[
     {GrayLevel[0], AbsoluteThickness[1.6], Opacity[1.], Dashing[{0, Small}], 
      LineBox[CompressedData["
1:eJwVx3k41HkcwPFpZjCDMNOztGWindKjHpFyFX018lTbTI4nZZ/KlSnZzQop
ajOmcR/pkcq0RESI3Y6RMD5fMZOsHEOrRxdCypFzfjNraHf/eD+v57026Fdv
PplEIvH+63/dXUIlD35m4tcF/YseUhq+GfL9btdQJr6190j46VoaHs9uUbSH
MLHeirnB1Cc0fO2LxdQYn4kbnQQtsgc0PHTj40aLACZmzVFydpTQsGjmaIH4
IBOLDj7buuEKDTeXeqRddmHiCGd+8lIADXOYdoE+hkzMX12UVUml4YdQ77Ct
goFLuhPLE5x1cKeBokbCY+D6XqKuKF4bv2f0PdWfMcJ/HmupDmvVwn4T+cP5
mUY4Yf+XcxKKFs4Ina7r3mKEm0b+8uT8SMXHBMtik8SGeHQy9jtuPAULsrUu
Ml8ZYOH1fBa1noy/fV7XPWhqgPcH/hJAppLx8WlpnKXPcsxXHxfGOS/D65wj
4iVifXzFYMcaNyEJN0/qXR7/qIdt/HvnQ298g33eZn25LD1cfTHG0VtvCTap
eYnpwbq46G1etTxXAzOeyqT5W3Sc03t1OYe+ADeNRCn0Xho+nUvpMBOoQbzC
qj/IjIab2E9mUhkqED73SLf11cFrrVNVFJES5A0ZGXvytfH5Qq1xXcY8fD3h
PqTo0cKn1PyO9XGzoIoe3E43/O+31wnvzU3DsVbxiOgQFa+c+Lu2RjQFpe1t
n6IzKdh9S0F429gEHDBetbOqm4x5iScLOZQx6JFxr2WZkjFJU16bbDkKyEKN
Pvssw7wmxXIWcxi0W7Fr0u8knNnuaddiPQgnXKibHUq/ga4qZE+h2Xu4VO3V
JzFdAkfxUHHoYi94VL+ygfsaGIlw+3rAXQFjJjxbCWsB5MUxkax1LYBIC+/s
ytSwm5O2GMR+Ct41kSn6ziqwcZfQ7Esvg7Xiw4eOP5QwYHre+p/11UgWIexn
7ZwH44yN9tJ0ObI4uzLdt3IWavJ0jIMvdSG0NDTAcpiBN3k6DU3cXmRy+KKD
U8sULEZXqkYX36JItkG4MGoSmtOOXHXLGUCWJVmy0owx8Nd0mi9ED6GocXV4
ScgoePQxqfevf0LOCtVqL+9haM8dpW+99wWdlQWvZpwZhAV1oIsgYQIlq8IG
Dha9h+4t/Z8lnlOIFj+57WH7a7gltTCRNk8j4d7cpJMm3fDhqkuknu0s4m1m
699+/gKoP3Gs7WEOPSJnSZJP1YOiuLhcbqtEQcziHVbkeghvCdu020mJmD/U
NHaJ68DVJvdZI1KiiF39L1e11UJex+FtUq4S2QhsRu5vfgrusb9tkJxQosrF
TuOuWQlIY7KPlomVyGOaPWWrqQLBOauEIjKBqoy4mgtWVRAoWaFk0wlkYBNF
k/lVgl3d47hiQwK1hTWbH26sAHNN1Lu7pgTaNx7sdSHxHjxOYcjK7Ank9unu
wyajOwCDcz7VoQS6o93eoM8pBDqp/ojjGQKRLZStPpEFQOuJuVB7jkCCF+ny
joo8aCAs6SAiUGzzyw0r7W/AoSdZ/i/yCeRIWeNafjMHTnbtcuDeJRCxK8zX
eSEbzL3TLDsqCBQFBikBOAvM1jj5vaohEF8j5Qy7Z0IqV17gCwQajPGLpOul
QViZy9IbGYECiKUiq84kKIJH0f5tBHoXdbvHK0cES2wX3Y8KAv0LO+mHTA==

       "]]},
     Annotation[#, "Charting`Private`Tag$11544#3"]& ]}, {}},
  AspectRatio->0.35,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-4.605170092210135, -9.287965448914875},
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Exp[
       Part[#, 1]], 
      Exp[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Exp[
       Part[#, 1]], 
      Exp[
       Part[#, 2]]}& )},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
     "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalG]\\), \\(\[Eta]\\)]\\)\"", 
      TraditionalForm], None}, {
     FormBox["\"\[Eta]\"", TraditionalForm], None}},
  FrameStyle->Directive["Times", 13, 
    GrayLevel[0]],
  FrameTicks->{{{{-9.210340371976182, 
       FormBox[
       "\"\\!\\(\\*SuperscriptBox[\\(10\\), \\(-4\\)]\\)\"", 
        TraditionalForm]}, {-8.517193191416238, 
       FormBox["\"\"", TraditionalForm]}, {-8.111728083308073, 
       FormBox["\"\"", TraditionalForm]}, {-7.824046010856292, 
       FormBox["\"\"", TraditionalForm]}, {-7.600902459542082, 
       FormBox["\"\"", TraditionalForm]}, {-7.418580902748128, 
       FormBox["\"\"", TraditionalForm]}, {-7.264430222920869, 
       FormBox["\"\"", TraditionalForm]}, {-7.1308988302963465`, 
       FormBox["\"\"", TraditionalForm]}, {-7.013115794639964, 
       FormBox["\"\"", TraditionalForm]}, {-6.907755278982137, 
       FormBox["\"\"", TraditionalForm]}, {-6.214608098422191, 
       FormBox["\"\"", TraditionalForm]}, {-5.809142990314028, 
       FormBox["\"\"", TraditionalForm]}, {-5.521460917862246, 
       FormBox["\"\"", TraditionalForm]}, {-5.298317366548036, 
       FormBox["\"\"", TraditionalForm]}, {-5.115995809754082, 
       FormBox["\"\"", TraditionalForm]}, {-4.961845129926823, 
       FormBox["\"\"", TraditionalForm]}, {-4.8283137373023015`, 
       FormBox["\"\"", TraditionalForm]}, {-4.710530701645918, 
       FormBox["\"\"", TraditionalForm]}, {-4.605170185988091, 
       FormBox[
       "\"\\!\\(\\*SuperscriptBox[\\(10\\), \\(-2\\)]\\)\"", 
        TraditionalForm]}, {-3.912023005428146, 
       FormBox["\"\"", TraditionalForm]}, {-3.506557897319982, 
       FormBox["\"\"", TraditionalForm]}, {-3.2188758248682006`, 
       FormBox["\"\"", TraditionalForm]}, {-2.995732273553991, 
       FormBox["\"\"", TraditionalForm]}, {-2.8134107167600364`, 
       FormBox["\"\"", TraditionalForm]}, {-2.659260036932778, 
       FormBox["\"\"", TraditionalForm]}, {-2.5257286443082556`, 
       FormBox["\"\"", TraditionalForm]}, {-2.4079456086518722`, 
       FormBox["\"\"", TraditionalForm]}, {-2.3025850929940455`, 
       FormBox["\"\"", TraditionalForm]}, {-1.6094379124341003`, 
       FormBox["\"\"", TraditionalForm]}, {-1.2039728043259361`, 
       FormBox["\"\"", TraditionalForm]}, {-0.916290731874155, 
       FormBox["\"\"", TraditionalForm]}, {-0.6931471805599453, 
       FormBox["\"\"", TraditionalForm]}, {-0.5108256237659907, 
       FormBox["\"\"", TraditionalForm]}, {-0.35667494393873245`, 
       FormBox["\"\"", TraditionalForm]}, {-0.2231435513142097, 
       FormBox["\"\"", TraditionalForm]}, {-0.10536051565782628`, 
       FormBox["\"\"", TraditionalForm]}, {0, 
       FormBox["\"1\"", TraditionalForm]}, {0.09531017980432493, 
       FormBox["\"\"", TraditionalForm]}, {0.1823215567939546, 
       FormBox["\"\"", TraditionalForm]}, {0.26236426446749106`, 
       FormBox["\"\"", TraditionalForm]}, {0.3364722366212129, 
       FormBox["\"\"", TraditionalForm]}, {0.4054651081081644, 
       FormBox["\"\"", TraditionalForm]}, {0.47000362924573563`, 
       FormBox["\"\"", TraditionalForm]}, {0.5306282510621704, 
       FormBox["\"\"", TraditionalForm]}, {0.5877866649021191, 
       FormBox["\"\"", TraditionalForm]}}, {}}, {{{-4.605170185988091, 
       FormBox[
       "\"\\!\\(\\*SuperscriptBox[\\(10\\), \\(-2\\)]\\)\"", 
        TraditionalForm]}, {-3.912023005428146, 
       FormBox["\"\"", TraditionalForm]}, {-3.506557897319982, 
       FormBox["\"\"", TraditionalForm]}, {-3.2188758248682006`, 
       FormBox["\"\"", TraditionalForm]}, {-2.995732273553991, 
       FormBox["\"\"", TraditionalForm]}, {-2.8134107167600364`, 
       FormBox["\"\"", TraditionalForm]}, {-2.659260036932778, 
       FormBox["\"\"", TraditionalForm]}, {-2.5257286443082556`, 
       FormBox["\"\"", TraditionalForm]}, {-2.4079456086518722`, 
       FormBox["\"\"", TraditionalForm]}, {-2.3025850929940455`, 
       FormBox[
       "\"\\!\\(\\*SuperscriptBox[\\(10\\), \\(-1\\)]\\)\"", 
        TraditionalForm]}, {-1.6094379124341003`, 
       FormBox["\"\"", TraditionalForm]}, {-1.2039728043259361`, 
       FormBox["\"\"", TraditionalForm]}, {-0.916290731874155, 
       FormBox["\"\"", TraditionalForm]}, {-0.6931471805599453, 
       FormBox["\"\"", TraditionalForm]}, {-0.5108256237659907, 
       FormBox["\"\"", TraditionalForm]}, {-0.35667494393873245`, 
       FormBox["\"\"", TraditionalForm]}, {-0.2231435513142097, 
       FormBox["\"\"", TraditionalForm]}, {-0.10536051565782628`, 
       FormBox["\"\"", TraditionalForm]}, {0, 
       FormBox["\"1\"", TraditionalForm]}}, {}}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotRange->{{-4.605170092210135, 0.09531017980432493}, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 0}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{
    Charting`ScaledTicks[
    "Log", {Log, Exp}, "Nice", WorkingPrecision -> MachinePrecision, 
     RotateLabel -> 0], 
    Charting`ScaledTicks[
    "Log", {Log, Exp}, "Nice", WorkingPrecision -> MachinePrecision, 
     RotateLabel -> 0]}]], "Output",
 CellChangeTimes->{3.962035246137959*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"2a7f6c3e-a293-4e85-885d-a3fdfc2fedfd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Protocol using the optimal probe state", "Section",
 FontSize->24,ExpressionUUID->"6b745ee0-1a96-4061-b5a7-4fbeb0bfc7bf"],

Cell[CellGroupData[{

Cell["Optimal POM", "Subsection",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.835544215236469*^9, 3.835544256497331*^9}, {
   3.8355442868352365`*^9, 3.835544333981597*^9}, {3.835544372403955*^9, 
   3.8355443741938467`*^9}, {3.835544411017234*^9, 3.8355444325933485`*^9}, {
   3.835725067480699*^9, 3.835725074133206*^9}, {3.835725262711372*^9, 
   3.835725272072914*^9}, {3.835725594073031*^9, 3.8357255965718393`*^9}, {
   3.835725891651462*^9, 3.83572589332251*^9}, {3.87224363358608*^9, 
   3.87224363407421*^9}, {3.924757913597479*^9, 3.924757914337286*^9}},
 FontSize->18,ExpressionUUID->"206ed985-8186-4caf-8cfc-893d02b93ef3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "a", ",", "\[Eta]", ",", "aux1", ",", "s1ket", ",", "s2ket", ",", "optPOM1",
    ",", "optPOM2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", "10"}], ";", 
   RowBox[{"\[Eta]", "=", "1"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aux1", "=", 
    RowBox[{"Eigenvectors", "[", 
     RowBox[{"LyapunovSolve", "[", 
      RowBox[{"\[Rho]0", ",", 
       RowBox[{"2", "\[Rho]1"}]}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "instead", " ", "of", " ", "S", " ", "to", " ", "avoid", " ",
      "numerical", " ", "issues", " ", "when", " ", "\[Eta]"}], " ", "=", " ",
     "1"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1ket", "=", 
   RowBox[{
    RowBox[{"aux1", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"aux1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"aux1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2ket", "=", 
   RowBox[{
    RowBox[{"aux1", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"aux1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"aux1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"optPOM1", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"s1ket", ",", "s1ket"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"optPOM2", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"s2ket", ",", "s2ket"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MatrixForm", "[", "s1ket", "]"}], ",", "\"\<,\>\"", ",", 
    RowBox[{"MatrixForm", "[", "s2ket", "]"}]}], "}"}], "]"}]}], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"d934d7c8-c908-4367-b1f0-4bd8054d7ee7"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
      TagBox[
       GridBox[{{"1"}, {"0"}}, ColumnAlignments -> Center, RowSpacings -> 1, 
        ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\",\"", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
      TagBox[
       GridBox[{{"0"}, {"1"}}, ColumnAlignments -> Center, RowSpacings -> 1, 
        ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{3.962035246222344*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"688d95f1-6485-4629-aa42-0f7e5017cf23"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Minimum error for the given state", "Subsection",
 FontSize->18,ExpressionUUID->"59f47834-5c03-4086-96fb-1ff912d76825"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"aux3", ",", "\[Epsilon]prior", ",", "\[Epsilon]MLE"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aux3", "=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"p", " ", 
      RowBox[{
       RowBox[{"f", "[", "\[Theta]", "]"}], "^", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Theta]min", ",", "\[Theta]max"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]prior", " ", "=", " ", 
   RowBox[{"aux3", "-", 
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"f", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Theta]min", ",", "\[Theta]max"}], "}"}], 
       ",", 
       RowBox[{"AccuracyGoal", "->", "8"}]}], "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Epsilon]MLE", "=", " ", 
  RowBox[{"aux3", "-", 
   RowBox[{"Tr", "[", 
    RowBox[{"\[Rho]1", ".", 
     RowBox[{"LyapunovSolve", "[", 
      RowBox[{"\[Rho]0", ",", 
       RowBox[{"2", "\[Rho]1"}]}], "]"}]}], "]"}]}]}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"34792605-25c8-422f-bad6-e4a47717e8d9"],

Cell[BoxData["0.9901795067104894`"], "Output",
 CellChangeTimes->{3.9620352462693357`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"3c4e30b3-4c08-4b63-b4e1-bea8a68ee660"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Protocol using a suboptimal probe state", "Section",
 FontSize->24,ExpressionUUID->"a2755e93-1efb-4110-a692-f8fcc9388455"],

Cell[CellGroupData[{

Cell["Optimal POM", "Subsection",
 CellChangeTimes->{{3.817233143803809*^9, 3.817233199044531*^9}, {
   3.8172332578133183`*^9, 3.8172332701269007`*^9}, {3.817233564849024*^9, 
   3.817233594389616*^9}, {3.81723363150721*^9, 3.8172336779358053`*^9}, {
   3.8172342701661744`*^9, 3.817234339227339*^9}, {3.8172343770344744`*^9, 
   3.8172343807447133`*^9}, {3.817234794265295*^9, 3.8172348320131474`*^9}, 
   3.8355439276342597`*^9, {3.835544215236469*^9, 3.835544256497331*^9}, {
   3.8355442868352365`*^9, 3.835544333981597*^9}, {3.835544372403955*^9, 
   3.8355443741938467`*^9}, {3.835544411017234*^9, 3.8355444325933485`*^9}, {
   3.835725067480699*^9, 3.835725074133206*^9}, {3.835725262711372*^9, 
   3.835725272072914*^9}, {3.835725594073031*^9, 3.8357255965718393`*^9}, {
   3.835725891651462*^9, 3.83572589332251*^9}, {3.87224363358608*^9, 
   3.87224363407421*^9}, {3.924757913597479*^9, 3.924757914337286*^9}},
 FontSize->18,ExpressionUUID->"0f8b14bf-a7bc-4e61-9b50-28d3bf537d1f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "\[Eta]sub", ",", "\[Eta]", ",", "aux1sub", ",", "s1ketSub", ",", 
   "s2ketSub", ",", "optPOM1sub", ",", "optPOM2sub"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]sub", "=", 
   RowBox[{"1.", "/", "3"}]}], ";", 
  RowBox[{"\[Eta]", "=", "\[Eta]sub"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aux1sub", "=", 
   RowBox[{"Eigenvectors", "[", "S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1ketSub", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"aux1sub", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"aux1sub", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"aux1sub", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2ketSub", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"aux1sub", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"aux1sub", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"aux1sub", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"optPOM1sub", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"s1ketSub", ",", "s1ketSub"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"optPOM2sub", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"s2ketSub", ",", "s2ketSub"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MatrixForm", "[", "s1ketSub", "]"}], ",", "\"\<,\>\"", ",", 
    RowBox[{"MatrixForm", "[", "s2ketSub", "]"}]}], "}"}], "]"}]}], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"34b0846a-7448-46ca-81a8-cf7dee45d441"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
      TagBox[
       GridBox[{{"0.89980619141895`"}, {"0.4362898324326663`"}}, 
        ColumnAlignments -> Center, RowSpacings -> 1, ColumnAlignments -> 
        Left], Column], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\",\"", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
      TagBox[
       GridBox[{{
          RowBox[{"-", "0.4362898324326663`"}]}, {"0.89980619141895`"}}, 
        ColumnAlignments -> Center, RowSpacings -> 1, ColumnAlignments -> 
        Left], Column], "\[NoBreak]", ")"}], 
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]},
  "RowDefault"]], "Output",
 CellChangeTimes->{3.962035246395966*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"e88dd2ab-92aa-4391-86ae-4ccfc86a20fb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Minimum error for the given state", "Subsection",
 FontSize->18,ExpressionUUID->"9bfd75f9-725f-44f1-9b87-a4dbcfaf7ee0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"aux3", ",", "\[Epsilon]MLEsub"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aux3", "=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"p", " ", 
      RowBox[{
       RowBox[{"f", "[", "\[Theta]", "]"}], "^", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Theta]min", ",", "\[Theta]max"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Epsilon]MLEsub", "=", 
  RowBox[{
   RowBox[{"aux3", "-", 
    RowBox[{"Tr", "[", 
     RowBox[{"\[Rho]1", ".", 
      RowBox[{"LyapunovSolve", "[", 
       RowBox[{"\[Rho]0", ",", 
        RowBox[{"2", "\[Rho]1"}]}], "]"}]}], "]"}]}], "/.", 
   RowBox[{"\[Eta]", "->", "\[Eta]sub"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "\[Eta]", "]"}]}], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"43311cdf-04fa-4cba-9ada-59f01e329759"],

Cell[BoxData["1.518876610717311`"], "Output",
 CellChangeTimes->{3.962035246429277*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"a51717fb-d04f-4647-a4b4-82818a46ae50"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{977, 553},
WindowMargins->{{Automatic, 79}, {Automatic, 13}},
DockedCells->{},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"13.0 para Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"404eed63-6889-48ab-95c5-8958101d5f52"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1755, 23, 86, "Title",ExpressionUUID->"767000d7-785a-403a-8259-7ce916f377d8"],
Cell[2338, 47, 3733, 65, 173, "Text",ExpressionUUID->"a03051b2-2b03-4276-b16a-9e3d90437730"],
Cell[CellGroupData[{
Cell[6096, 116, 1414, 20, 62, "Section",ExpressionUUID->"74549090-f68b-47b6-acbc-910ca3bf395a"],
Cell[7513, 138, 7907, 140, 94, "Input",ExpressionUUID->"adda10d2-08f0-406f-87f9-9c490536ee54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15457, 283, 578, 11, 62, "Section",ExpressionUUID->"d3a8ef32-eb94-4841-9a5d-c4182692f2dd"],
Cell[CellGroupData[{
Cell[16060, 298, 1254, 25, 53, "Subsection",ExpressionUUID->"41869885-8cff-4460-b8e9-d5632f56cb6d"],
Cell[17317, 325, 3143, 52, 52, "Input",ExpressionUUID->"72ead34d-cec7-4025-b947-0bbbad4aa368"],
Cell[20463, 379, 3037, 50, 52, "Input",ExpressionUUID->"5d3a53dc-2d56-482d-bd35-ad3b2b83a3f5"],
Cell[23503, 431, 1743, 27, 52, "Input",ExpressionUUID->"d14233e0-4af5-4b96-8e27-1173f72dd7e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25283, 463, 1012, 13, 51, "Subsection",ExpressionUUID->"9b651d5f-ee0b-4528-ba46-6e00562edfc5"],
Cell[CellGroupData[{
Cell[26320, 480, 8559, 208, 341, "Input",ExpressionUUID->"19b7796a-ca30-4884-8b45-0dedbf4f662c"],
Cell[34882, 690, 11889, 225, 168, "Output",ExpressionUUID->"2a7f6c3e-a293-4e85-885d-a3fdfc2fedfd"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46832, 922, 127, 1, 62, "Section",ExpressionUUID->"6b745ee0-1a96-4061-b5a7-4fbeb0bfc7bf"],
Cell[CellGroupData[{
Cell[46984, 927, 991, 13, 51, "Subsection",ExpressionUUID->"206ed985-8186-4caf-8cfc-893d02b93ef3"],
Cell[CellGroupData[{
Cell[48000, 944, 2409, 71, 178, "Input",ExpressionUUID->"d934d7c8-c908-4367-b1f0-4bd8054d7ee7"],
Cell[50412, 1017, 704, 18, 49, "Output",ExpressionUUID->"688d95f1-6485-4629-aa42-0f7e5017cf23"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51165, 1041, 125, 1, 51, "Subsection",ExpressionUUID->"59f47834-5c03-4086-96fb-1ff912d76825"],
Cell[CellGroupData[{
Cell[51315, 1046, 1220, 34, 94, "Input",ExpressionUUID->"34792605-25c8-422f-bad6-e4a47717e8d9"],
Cell[52538, 1082, 169, 2, 34, "Output",ExpressionUUID->"3c4e30b3-4c08-4b63-b4e1-bea8a68ee660"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52768, 1091, 128, 1, 62, "Section",ExpressionUUID->"a2755e93-1efb-4110-a692-f8fcc9388455"],
Cell[CellGroupData[{
Cell[52921, 1096, 991, 13, 51, "Subsection",ExpressionUUID->"0f8b14bf-a7bc-4e61-9b50-28d3bf537d1f"],
Cell[CellGroupData[{
Cell[53937, 1113, 2200, 66, 178, "Input",ExpressionUUID->"34b0846a-7448-46ca-81a8-cf7dee45d441"],
Cell[56140, 1181, 816, 21, 49, "Output",ExpressionUUID->"e88dd2ab-92aa-4391-86ae-4ccfc86a20fb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57005, 1208, 125, 1, 51, "Subsection",ExpressionUUID->"9bfd75f9-725f-44f1-9b87-a4dbcfaf7ee0"],
Cell[CellGroupData[{
Cell[57155, 1213, 891, 23, 94, "Input",ExpressionUUID->"43311cdf-04fa-4cba-9ada-59f01e329759"],
Cell[58049, 1238, 166, 2, 34, "Output",ExpressionUUID->"a51717fb-d04f-4647-a4b4-82818a46ae50"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

